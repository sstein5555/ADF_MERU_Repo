steps:
  Invoice_Amounts-6cbdcc75-9616-48ec-95e9-b79240d9b295:
    operation:
      config:
        postSQL: ""
        preSQL: ""
        testsEnabled: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: FINANCIAL_DATA_MODEL
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 3c5e210c-c1a6-409a-a4a9-74f4a104ccc4
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: Unique ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d7e5df06-c42d-48f7-9423-164473c586e5
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: f799cde5-2702-492d-be83-b43e55baefd9
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: Customer Number
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: be34aa24-d92c-4f00-b2db-876b289ec1f5
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: 5379cca1-7f0b-4e64-bbd8-c71aec741730
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: Site Number
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f6d1bc36-8df3-49ee-8a55-f20a2724460b
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: 581c44d4-daea-4fc9-a443-158eec519821
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR(13)
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: Invoice Number
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9e4aa363-15b7-4450-9ff5-77a6308a3d67
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: e6f56b2b-1b54-43c6-98e4-586d31c8653d
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Invoice Date
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 23e93a5c-89c7-41d0-bf72-70e214901c62
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: 7a814a12-2b45-4df3-a1eb-df6fa25e93f4
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: NUMBER(38,0)
            description: can join with CM03/Site master
            hashColumns: []
            hashDetails: null
            name: Service Site Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5d5b5cf-169d-47c1-a837-0ffc19e60308
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: f26798cf-9330-4580-9bbc-c228d810fb8d
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR(14)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Bill Tickets Individually
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5b9ca85c-f208-4f36-9286-8768075a8d68
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: c328f350-1c9b-4109-9789-9255c8d4459b
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Payable Flag
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 38220971-5a11-4792-b04e-4560ec7ddcda
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: 3b2815fe-33b1-4b79-bf37-f33e6c25342d
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Contract
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 52ce0dd7-738d-4134-8e17-913ccf9b223e
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: 5a271921-8496-4417-9c96-77c87aa5e397
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: NUMBER(18,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Amount
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 96ddaeaa-ca18-4ae9-87cf-e8e26304f121
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: bfddf279-7a37-43e1-83b3-c3763ebb1699
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Credit Memo Link to Invoice Record
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a66ecb07-4f9f-4756-b0b0-d276474ef90c
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - columnReference:
              columnCounter: e4337c49-1766-460d-ad3f-94fbcba823cc
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR
            description: ""
            hashColumns: []
            hashDetails: null
            name: SOURCE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bb31073d-6a03-4ae4-b11f-136ca78c5aa9
                    stepCounter: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: d9823e5a-b575-4299-8f8c-1cca0adcfa16
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            isSystemCreateDate: true
            name: SYSTEM_CREATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7fb17d17-cf00-4b48-b4dc-cc6934b97325
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            isSystemUpdateDate: true
            name: SYSTEM_UPDATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: c6879ef4-beac-426d-aa95-ec4058ddb673
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: varchar
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Customer_Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "\"DM01_COMBINED\".\"DM01_CUST\"||\"DM01_COMBINED\".\"SOURCE\""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 9201fbce-c10b-4c18-9853-a9b4bba17628
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: varchar
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Customer_Site_Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "\"DM01_COMBINED\".\"DM01_CUST\"||\"DM01_COMBINED\".\"DM01_SSIT\"||\"DM01_COMBINED\".\"SOURCE\""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: bbaeae2b-c40f-4a97-be3d-688aaaf24606
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: varchar
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: ID_Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "\"DM01_COMBINED\".\"DM01_ID\"||\"DM01_COMBINED\".\"SOURCE\""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b33c72dd-b126-4d05-9c2e-86eed63ed17e
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Initial Term Cust
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d8fc5bf7-df15-42fe-8363-94cbe665d3e8
                    stepCounter: a83e2043-c50d-4bf2-8f19-a0858a24d969
                transform: ""
            systemColumnType: None
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              CUSTOMER_MASTER: a83e2043-c50d-4bf2-8f19-a0858a24d969
              DM01_COMBINED: 4db4aca4-5fea-4718-b761-1c7aa638e0c3
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: MASTER_DATA_CLEAN
                nodeName: CUSTOMER_MASTER
              - locationName: TRUXCOMBINED_RAW
                nodeName: DM01_COMBINED
            join:
              joinCondition: |-
                FROM {{ ref('TRUXCOMBINED_RAW', 'DM01_COMBINED') }} "DM01_COMBINED"
                LEFT JOIN {{ ref('MASTER_DATA_CLEAN', 'CUSTOMER_MASTER') }} "CUSTOMER_MASTER"
                ON "DM01_COMBINED"."DM01_CUST"||"DM01_COMBINED"."SOURCE" = "CUSTOMER_MASTER"."Customer_Source"
            name: Invoice_Amounts
            noLinkRefs: []
      name: Invoice_Amounts
      overrideSQL: false
      schema: ""
      sqlType: Fact
      type: sql
    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
